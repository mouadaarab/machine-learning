{% include "includes/header.html" %}
<div class="container">
    <!-- Navigation de retour -->
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="{% url 'algosAi:index' %}">Accueil</a></li>
            <li class="breadcrumb-item"><a href="{% url 'algosAi:dt_details' %}">Decision Tree</a></li>
            <li class="breadcrumb-item active" aria-current="page">Régression Housing</li>
        </ol>
    </nav>

    <!-- Titre -->
    <div class="row mb-4">
        <div class="col-md-12">
            <div class="card">
                <div class="card-header bg-success text-white">
                    <h1 class="h3 mb-0">🌳 Decision Tree - Régression California Housing</h1>
                </div>
                <div class="card-body">
                    <p class="lead">Prédiction des prix immobiliers avec un arbre de décision interprétable</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Navigation interne -->
    <div class="row mb-4">
        <div class="col-md-12">
            <div class="card">
                <div class="card-header bg-dark text-white">
                    <h4>🧭 Navigation</h4>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-3">
                            <a href="{% url 'algosAi:dt_details' %}" class="btn btn-outline-primary btn-sm w-100 mb-2">
                                📖 Théorie Decision Tree
                            </a>
                        </div>
                        <div class="col-md-3">
                            <a href="{% url 'algosAi:dt_iris' %}" class="btn btn-outline-success btn-sm w-100 mb-2">
                                🌸 Classification Iris
                            </a>
                        </div>
                        <div class="col-md-3">
                            <span class="btn btn-success btn-sm w-100 mb-2">
                                🏠 Régression Housing (Actuel)
                            </span>
                        </div>
                        <div class="col-md-3">
                            <a href="{% url 'algosAi:dt_housing_exemple_tester' %}" class="btn btn-outline-warning btn-sm w-100 mb-2">
                                🧪 Tester le Modèle
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Description -->
    <div class="alert alert-info" role="alert">
        <h5>🎯 Objectif</h5>
        <p>Utiliser un arbre de décision pour prédire les prix des logements en Californie. Ce modèle offre l'avantage d'être complètement <strong>interprétable</strong> : vous pouvez voir exactement quelles règles sont utilisées pour chaque prédiction !</p>
    </div>

    <!-- Dataset California Housing -->
    <div class="row mb-4">
        <div class="col-md-12">
            <div class="card">
                <div class="card-header bg-primary text-white">
                    <h4>🏠 Dataset California Housing</h4>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <h5>📊 Informations générales</h5>
                            <ul>
                                <li><strong>Échantillons :</strong> 20,640 quartiers</li>
                                <li><strong>Caractéristiques :</strong> 8 variables explicatives</li>
                                <li><strong>Cible :</strong> Prix médian des logements (en centaines de milliers $)</li>
                                <li><strong>Source :</strong> Recensement américain de 1990</li>
                                <li><strong>Géographie :</strong> Californie entière</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h5>🔧 Préparation des données</h5>
                            <ul>
                                <li>✅ Données déjà normalisées</li>
                                <li>✅ Pas de valeurs manquantes</li>
                                <li>✅ Variables numériques continues</li>
                                <li>✅ Cible continue (régression)</li>
                                <li>✅ Split 80/20 train/test</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Caractéristiques détaillées -->
    <div class="row mb-4">
        <div class="col-md-12">
            <div class="card">
                <div class="card-header bg-secondary text-white">
                    <h4>📋 Variables explicatives</h4>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <h5>🏘️ Caractéristiques des quartiers</h5>
                            <ul>
                                <li><strong>MedInc:</strong> Revenu médian (Facteur le plus important - 61.8%)</li>
                                <li><strong>HouseAge:</strong> Âge médian des maisons (4.5% d'importance)</li>
                                <li><strong>Population:</strong> Population du quartier</li>
                                <li><strong>AveOccup:</strong> Occupation moyenne (13.2% d'importance)</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h5>🗺️ Géographie et logements</h5>
                            <ul>
                                <li><strong>Latitude/Longitude:</strong> Position géographique (14.5% combiné)</li>
                                <li><strong>AveRooms:</strong> Nombre moyen de pièces par logement</li>
                                <li><strong>AveBedrms:</strong> Nombre moyen de chambres par logement</li>
                                <li><strong>Cible:</strong> Prix médian en centaines de milliers $</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Performance du modèle -->
    <div class="row mb-4">
        <div class="col-md-12">
            <div class="card">
                <div class="card-header bg-info text-white">
                    <h4>📊 Performance du Modèle Decision Tree</h4>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-4">
                            <div class="text-center p-3 bg-light rounded">
                                <h5>🎯 R² Score</h5>
                                <h2 class="text-primary">0.689</h2>
                                <small class="text-muted">69% de la variance expliquée</small>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="text-center p-3 bg-light rounded">
                                <h5>📏 RMSE</h5>
                                <h2 class="text-warning">$63,850</h2>
                                <small class="text-muted">Erreur moyenne de prédiction</small>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="text-center p-3 bg-light rounded">
                                <h5>⚖️ Comparaison</h5>
                                <p><strong>vs Random Forest:</strong></p>
                                <ul class="small text-start">
                                    <li>RF: R² = 0.77</li>
                                    <li>DT: R² = 0.69</li>
                                    <li><strong>DT plus interprétable</strong></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Métriques de régression -->
    <div class="row mb-4">
        <div class="col-md-12">
            <div class="card">
                <div class="card-header bg-dark text-white">
                    <h4>📏 Comprendre les métriques de régression</h4>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-4">
                            <h5>🎯 R² (Coefficient de détermination)</h5>
                            <p>Proportion de la variance dans la variable dépendante qui est prédictible à partir des variables indépendantes.</p>
                            <ul>
                                <li><strong>1.0 :</strong> Prédiction parfaite</li>
                                <li><strong>0.0 :</strong> Pas mieux qu'une moyenne</li>
                                <li><strong>Négatif :</strong> Pire qu'une moyenne</li>
                            </ul>
                        </div>
                        <div class="col-md-4">
                            <h5>📊 RMSE (Root Mean Square Error)</h5>
                            <p>Racine carrée de la moyenne des erreurs au carré. Même unité que la variable cible.</p>
                            <ul>
                                <li><strong>Interprétation :</strong> Erreur "typique"</li>
                                <li><strong>Sensible :</strong> Aux valeurs aberrantes</li>
                                <li><strong>Unité :</strong> Dollars pour les prix</li>
                            </ul>
                        </div>
                        <div class="col-md-4">
                            <h5>📈 MAE (Mean Absolute Error)</h5>
                            <p>Moyenne des valeurs absolues des erreurs. Plus robuste aux outliers.</p>
                            <ul>
                                <li><strong>Robuste :</strong> Aux valeurs aberrantes</li>
                                <li><strong>Interprétation :</strong> Erreur médiane</li>
                                <li><strong>Linéaire :</strong> Toutes erreurs égales</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Exemple de règles -->
    <div class="row mb-4">
        <div class="col-md-12">
            <div class="card">
                <div class="card-header bg-success text-white">
                    <h4>🌳 Exemple de Règles de Décision</h4>
                </div>
                <div class="card-body">
                    <div class="alert alert-light border">
                        <h5>📋 Règles simplifiées du Decision Tree :</h5>
                        <code style="display: block; white-space: pre-line; font-size: 1.1em;">
Si MedInc ≤ 5.0 ET Latitude > 34.0 → Prix ≈ $150,000
Si MedInc > 5.0 ET AveOccup ≤ 3.0 → Prix ≈ $300,000  
Si MedInc > 8.0 ET Latitude ≤ 37.5 → Prix ≈ $500,000
                        </code>
                        <small class="text-muted">* Règles simplifiées à des fins d'illustration. L'arbre complet contient plusieurs dizaines de règles.</small>
                    </div>
                    <p><strong>Avantage clé :</strong> Chaque prédiction peut être tracée et expliquée step-by-step !</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Implémentation -->
    <div class="row mb-4">
        <div class="col-md-12">
            <div class="card">
                <div class="card-header bg-warning text-dark">
                    <h4>⚙️ Étapes d'implémentation</h4>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <h5>🔧 Préparation</h5>
                            <ol>
                                <li>Chargement du dataset California Housing</li>
                                <li>Division train/test (80/20)</li>
                                <li>Pas de normalisation requise pour DT</li>
                            </ol>
                        </div>
                        <div class="col-md-6">
                            <h5>🎯 Entraînement</h5>
                            <ol>
                                <li>Configuration DecisionTreeRegressor</li>
                                <li>Ajustement sur données d'entraînement</li>
                                <li>Évaluation sur données de test</li>
                                <li>Sauvegarde du modèle final</li>
                            </ol>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Alertes informatives -->
    <div class="row mb-4">
        <div class="col-md-6">
            <div class="alert alert-info" role="alert">
                <h5>ℹ️ Information</h5>
                <p>Le modèle entraîné et sauvegardé dans cet atelier est celui utilisé dans le test. Bien que légèrement moins précis que Random Forest, le Decision Tree offre l'avantage d'être <strong>complètement interprétable</strong>.</p>
            </div>
        </div>
        <div class="col-md-6">
            <div class="alert alert-success" role="alert">
                <h5>✨ Avantage principal</h5>
                <p>Vous pouvez tracer l'arbre de décision et voir exactement quelles règles sont utilisées pour chaque prédiction ! Parfait pour l'explicabilité.</p>
            </div>
        </div>
    </div>

    <!-- Call to action -->
    <div class="row">
        <div class="col-md-12">
            <div class="card">
                <div class="card-header bg-primary text-white">
                    <h4>🧪 Tester le modèle</h4>
                </div>
                <div class="card-body text-center">
                    <p>Prêt à voir le Decision Tree en action ? Testez le modèle avec vos propres données !</p>
                    <a href="{% url 'algosAi:dt_housing_exemple_tester' %}" class="btn btn-primary btn-lg">
                        🏠 Tester le Modèle Decision Tree
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

{% include "includes/footer.html" %}
